{"version":3,"file":"table_body.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/table_body/index.js"],"sourcesContent":["export default function tableBody(stanza, params) {\n  let formBody = []\n  for (let key in params) {\n    if(params[key] && key != \"table_data_api\") formBody.push(key + \"=\" + encodeURIComponent(params[key]))\n  }\n  let options = {\n    method: \"POST\",\n    mode:  \"cors\",\n    body: formBody.join(\"&\"),\n    headers: {\n      \"Accept\": \"application/json\",\t    \n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  }\n  console.log(params);\n  console.log(options.body);\n  let url = params.table_data_api;\n  let q = fetch(url, options).then(res => res.json());\n  q.then(function(data){\n    stanza.render({\n      template: \"stanza.html.hbs\"\n    });\n    let div = stanza.select(\"#renderDiv\");\n    let table = document.createElement(\"table\");\n    let thead = document.createElement(\"thead\");\n    let tbody = document.createElement(\"tbody\");\t\n    div.appendChild(table);\n    table.appendChild(thead);\n    table.appendChild(tbody);\n\n    let order = [];\n    for (let i = 0;  i < data.head.order.length; i++) {\n      if (parseInt(data.head.order[i]) >= 0) {\n\torder[parseInt(data.head.order[i])] = i;\n      }\n    }\n    \n    let tr = document.createElement(\"tr\");\n    thead.appendChild(tr);\n    for(let i of order){\n      let th = document.createElement(\"th\");\n      th.innerHTML = data.head.labels[i];\n      tr.appendChild(th);\n    }\n    for(let row of data.body){\n      tr = document.createElement(\"tr\");\n      tbody.appendChild(tr);\n      for(let j of order){\n\tlet td = document.createElement(\"td\");\n\tif (data.head.href[j]) {\n\t  let a = document.createElement(\"a\");\n\t  a.setAttribute(\"href\", row[data.head.href[j]].value);\n\t  a.innerHTML = row[data.head.vars[j]].value;\n\t  td.appendChild(a);\n\t} else {\n\t  td.innerHTML = row[data.head.vars[j]].value;\n\t}\n\ttr.appendChild(td);\n      }\n    }\n  });\n}\n"],"names":[],"mappings":";;AAAe,SAAS,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE;AAClD,EAAE,IAAI,QAAQ,GAAG,GAAE;AACnB,EAAE,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;AAC1B,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,gBAAgB,EAAE,QAAQ,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,EAAC;AACzG,GAAG;AACH,EAAE,IAAI,OAAO,GAAG;AAChB,IAAI,MAAM,EAAE,MAAM;AAClB,IAAI,IAAI,GAAG,MAAM;AACjB,IAAI,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC;AAC5B,IAAI,OAAO,EAAE;AACb,MAAM,QAAQ,EAAE,kBAAkB;AAClC,MAAM,cAAc,EAAE,mCAAmC;AACzD,KAAK;AACL,IAAG;AACH,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACtB,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC5B,EAAE,IAAI,GAAG,GAAG,MAAM,CAAC,cAAc,CAAC;AAClC,EAAE,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;AACtD,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC;AACvB,IAAI,MAAM,CAAC,MAAM,CAAC;AAClB,MAAM,QAAQ,EAAE,iBAAiB;AACjC,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAC1C,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAChD,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAChD,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAChD,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AAC3B,IAAI,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AAC7B,IAAI,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AAC7B;AACA,IAAI,IAAI,KAAK,GAAG,EAAE,CAAC;AACnB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACtD,MAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;AAC7C,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACzC,OAAO;AACP,KAAK;AACL;AACA,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AAC1C,IAAI,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AAC1B,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,CAAC;AACvB,MAAM,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AAC5C,MAAM,EAAE,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;AACzC,MAAM,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AACzB,KAAK;AACL,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC;AAC7B,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AACxC,MAAM,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AAC5B,MAAM,IAAI,IAAI,CAAC,IAAI,KAAK,CAAC;AACzB,CAAC,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AACvC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;AACxB,GAAG,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AACvC,GAAG,CAAC,CAAC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;AACxD,GAAG,CAAC,CAAC,SAAS,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;AAC9C,GAAG,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;AACrB,EAAE,MAAM;AACR,GAAG,EAAE,CAAC,SAAS,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;AAC/C,EAAE;AACF,CAAC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;AACpB,OAAO;AACP,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}