{"version":3,"file":"load-data-b8c62ee7.js","sources":["../../../home/runner/work/metastanza/metastanza/node_modules/togostanza-utils/load-data.js"],"sourcesContent":["import * as d3 from \"d3\";\n\n// TODO: test\nexport default function loadData(url, type = \"json\") {\n  switch (type) {\n    case \"tsv\":\n      return loadTSV(url);\n    case \"csv\":\n      return loadCSV(url);\n    case \"sparql-results-json\":\n      return loadSPARQL(url);\n    case \"json\":\n    default:\n      return loadJSON(url);\n  }\n}\n\nfunction loadTSV(url) {\n  // expect TSV data with a header line\n  return d3.tsv(url);\n}\n\nfunction loadCSV(url) {\n  // expect CSV data with a header line\n  return d3.csv(url);\n}\n\nasync function loadJSON(url, accept = \"application/json\") {\n  const res = await fetch(url, { headers: { Accept: accept } });\n  return await res.json();\n}\n\nasync function loadSPARQL(url) {\n  const json = await loadJSON(url, \"application/sparql-results+json\");\n  return sparql2table(json);\n}\n\n// async function sparql2tree(url){\n//   const json = await loadJSON(url);\n//   const treeJson = sparql2table(json); //rootのオブジェクトが必要\n//   const rootNode = {\n//     \"child_name\": sparql2table(json)[0].root_name\n//   }\n\n//   treeJson.unshift(rootNode);\n//   treeJson.forEach(data => {\n//     if(!treeJson.some(datum => data.parent_name === datum.child_name)) {\n//       console.log('親無し', data)\n//     }\n//   })\n//   return treeJson;\n\n//   //test loading function\n//   const array1 = sparql2table(json); //rootのオブジェクトが必要\n//   const rootNode = {\n//     \"child_name\": sparql2table(json)[0].root_name\n//   }\n\n//   array1.unshift(rootNode);\n//   array1.forEach(data => {\n//     if(!array1.some(datum => data.parent_name === datum.child_name)) {\n//       console.log('親無し', data)\n//     }\n//   })\n//   console.log(\"array1\",array1);\n\n//   const testData =\n//   [\n//     {\n//       \"child_name\": \"first\",\n//     },\n//     {\n//       \"child_name\": \"second\",\n//       \"parent_name\": \"first\"\n//     },\n//     {\n//       \"child_name\": \"forth\",\n//       \"parent_name\": \"first\"\n//     },\n//     {\n//       \"child_name\": \"third\",\n//       \"parent_name\": \"second\"\n//     }\n//   ]\n//   console.log('testData',testData)\n\n//   return array1;\n//   return testData;\n// }\n\n// TODO: test & improve\nfunction sparql2table(json) {\n  const head = json.head.vars;\n  const data = json.results.bindings;\n\n  return data.map((item) => {\n    const row = {};\n    head.forEach((key) => {\n      row[key] = item[key] ? item[key].value : \"\";\n    });\n    return row;\n  });\n}\n"],"names":["d3.tsv","d3.csv"],"mappings":";;;AAEA;AACe,SAAS,QAAQ,CAAC,GAAG,EAAE,IAAI,GAAG,MAAM,EAAE;AACrD,EAAE,QAAQ,IAAI;AACd,IAAI,KAAK,KAAK;AACd,MAAM,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC;AAC1B,IAAI,KAAK,KAAK;AACd,MAAM,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC;AAC1B,IAAI,KAAK,qBAAqB;AAC9B,MAAM,OAAO,UAAU,CAAC,GAAG,CAAC,CAAC;AAC7B,IAAI,KAAK,MAAM,CAAC;AAChB,IAAI;AACJ,MAAM,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;AAC3B,GAAG;AACH,CAAC;AACD;AACA,SAAS,OAAO,CAAC,GAAG,EAAE;AACtB;AACA,EAAE,OAAOA,GAAM,CAAC,GAAG,CAAC,CAAC;AACrB,CAAC;AACD;AACA,SAAS,OAAO,CAAC,GAAG,EAAE;AACtB;AACA,EAAE,OAAOC,GAAM,CAAC,GAAG,CAAC,CAAC;AACrB,CAAC;AACD;AACA,eAAe,QAAQ,CAAC,GAAG,EAAE,MAAM,GAAG,kBAAkB,EAAE;AAC1D,EAAE,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,GAAG,EAAE,EAAE,OAAO,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC;AAChE,EAAE,OAAO,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;AAC1B,CAAC;AACD;AACA,eAAe,UAAU,CAAC,GAAG,EAAE;AAC/B,EAAE,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,GAAG,EAAE,iCAAiC,CAAC,CAAC;AACtE,EAAE,OAAO,YAAY,CAAC,IAAI,CAAC,CAAC;AAC5B,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,YAAY,CAAC,IAAI,EAAE;AAC5B,EAAE,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;AAC9B,EAAE,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;AACrC;AACA,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK;AAC5B,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;AACnB,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK;AAC1B,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AAClD,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,GAAG,CAAC;AACf,GAAG,CAAC,CAAC;AACL;;;;"}