{"version":3,"file":"manhattan_plot.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/manhattan_plot/index.js"],"sourcesContent":["import * as d3 from 'd3';\nimport metastanza from '@/lib/metastanza_utils.js';\n\nexport default async function manhattanPlot(stanza, params) {\n  stanza.render({\n    template: 'stanza.html.hbs',\n    parameters: {\n      title: params.title\n    }\n  });\n\n  console.log(params.api);\n  let dataset = await metastanza.getFormatedJson(params.api, stanza.root.querySelector('#chart'));\n  if (typeof dataset == \"object\") draw(dataset, stanza, params);\n}\n\nasync function draw(dataset, stanza, params) {\n  const width = 800;\n  const height = 400;\n  const marginLeft = 30;\n  const marginBottom = 30;\n  const areaWidth = width - marginLeft;\n  const areaHeight = height - marginBottom;\n\n  const chart_element = stanza.root.querySelector('#chart');\n  const control_element = stanza.root.querySelector('#control');\n\n  if (params.low_thresh == \"\") params.low_thresh = 0.5;\n  if (params.high_thresh == \"\") params.high_thresh = Infinity;\n  const low_thresh = parseFloat(params.low_thresh);\n  const high_thresh = parseFloat(params.high_thresh);\n  const even_and_odd = (params.even_and_odd == 'true');\n\n  const chromosomes = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"20\",\"21\", \"22\", \"X\", \"Y\"];\n  const chromosomeNtLength = {\n    hg38: {\n      1: 248956422,\n      2: 242193529,\n      3: 198295559,\n      4: 190214555,\n      5: 181538259,\n      6: 170805979,\n      7: 159345973,\n      8: 145138636,\n      9: 138394717,\n      10: 133797422,\n      11: 135086622,\n      12: 133275309,\n      13: 114364328,\n      14: 107043718,\n      15: 101991189,\n      16: 90338345,\n      17: 83257441,\n      18: 80373285,\n      19: 58617616,\n      20: 64444167,\n      21: 46709983,\n      22: 50818468,\n      X: 156040895,\n      Y: 57227415\n    }\n  }\n  \n  let svg = d3.select(chart_element).append(\"svg\").attr(\"width\", width).attr(\"height\", height);\n  let plot_g = svg.append(\"g\").attr(\"id\", \"plot_group\");\n  let axis_g = svg.append(\"g\").attr(\"id\", \"axis\");\n  let xlabel_g = svg.append(\"g\").attr(\"id\", \"x_label\");\n  let ylabel_g = svg.append(\"g\").attr(\"id\", \"y_label\");\n  \n  let range = []; // [begin position, en _position]\n  let max_log_p = 0;\n  let max_log_p_int = 0;\n  let total;\n\n  // axis line\n  axis_g.append(\"path\")\n    .attr(\"d\", \"M \" + marginLeft + \", \" + areaHeight + \" H \" + width +  \" Z\")\n    .attr(\"class\", \"axis-line\");\n  axis_g.append(\"path\")\n    .attr(\"d\", \"M \" + marginLeft + \", 0 V \" + areaHeight +  \" Z\")\n    .attr(\"class\", \"axis-line\");\n\n  // select range by drag\n  let dragBegin = false;\n  svg.on(\"mousedown\", function(e, d){\n    if (d3.pointer(e)[1] <= areaHeight) {\n      dragBegin = d3.pointer(e)[0];\n      svg.append(\"rect\")\n\t.attr(\"fill\", \"rgba(128, 128, 128, 0.2)\")\n\t.attr(\"stroke\", \"black\")\n\t.attr(\"x\", dragBegin)\n\t.attr(\"y\", 0)\n\t.attr(\"width\", 0)\n\t.attr(\"height\", areaHeight)\n\t.attr(\"id\", \"selector\");\n    }\n  })\n    .on(\"mousemove\", function(e, d){\n      if(dragBegin){\n\tlet dragEnd = d3.pointer(e)[0];\n\tif (dragBegin < dragEnd) {\n\t  svg.select(\"#selector\")\n\t    .attr(\"width\", dragEnd - dragBegin);\n\t} else {\n\t  svg.select(\"#selector\")\n\t    .attr(\"x\", dragEnd)\n\t    .attr(\"width\", dragBegin - dragEnd);\n\t}\n      }\n    })\n    .on(\"mouseup\", function(e, d){\n      if(dragBegin){\n\tlet dragEnd = d3.pointer(e)[0];\n\t// re-render\n\tif (-5 > dragEnd - dragBegin) {\n\t  range = [dragEnd / width * (range[1] - range[0]) + range[0], dragBegin / width * (range[1] - range[0]) + range[0]];\n\t  reRender();\n\t} else if (dragEnd - dragBegin > 5) {\n\t  range = [dragBegin / width * (range[1] - range[0]) + range[0], dragEnd / width * (range[1] - range[0]) + range[0]];\n\t  reRender();\n\t}\n\tsvg.select(\"#selector\").remove();\n\tdragBegin = false;\n      }\n    });\n\n  // slider\n  let ctrl_svg = d3.select(control_element).append(\"svg\").attr(\"width\", width).attr(\"height\", 20);\n  ctrl_svg.append(\"path\")\n    .attr(\"d\", \"M \" + marginLeft + \", 10 H \" + width +  \" Z\")\n    .attr(\"stroke\", \"#888888\")\n    .attr(\"stroke-width\", \"2px\");\n  ctrl_svg.append(\"rect\")\n    .attr(\"id\", \"slider\")\n    .attr(\"x\", marginLeft)\n    .attr(\"y\", 2)\n    .attr(\"width\", areaWidth)\n    .attr(\"height\", 16)\n    .attr(\"fill\", \"#8888ff\")\n    .call(\n      d3.drag()\n\t.on(\"start\", function(e){ dragBegin = e.x })\n\t.on(\"drag\", function(e){\n\t  if(dragBegin) {\n\t    let slider = ctrl_svg.select(\"rect#slider\");\n\t    let delta = e.x - dragBegin;\n\t    if (parseFloat(slider.attr(\"x\")) + delta < marginLeft) delta = (parseFloat(slider.attr(\"x\")) - marginLeft) * (-1);\n\t    else if (parseFloat(slider.attr(\"x\")) + parseFloat(slider.attr(\"width\")) + delta > width) delta = width - (parseFloat(slider.attr(\"x\")) + parseFloat(slider.attr(\"width\")));\n\t    slider.attr(\"transform\", \"translate(\" + delta + \", 0)\");\n\t  }\n\t})\n\t.on(\"end\", function(e){\n\t  if(dragBegin){\n\t    // re-render\n\t    let slider = ctrl_svg.select(\"rect#slider\");\n\t    let delta = e.x - dragBegin;\n\t    if (parseFloat(slider.attr(\"x\")) + delta < marginLeft) delta = (parseFloat(slider.attr(\"x\")) - marginLeft) * (-1);\n\t    else if (parseFloat(slider.attr(\"x\")) + parseFloat(slider.attr(\"width\")) + delta > width) delta = width - (parseFloat(slider.attr(\"x\")) + parseFloat(slider.attr(\"width\")));\n\t    let move = delta / areaWidth * total;\n\t    range = [range[0] + move, range[1] + move];\n\t    reRender();\n\t    dragBegin = false;\n\t  }\n\t})\n    );\n  \n  // button\n  let ctrl_button = d3.select(control_element).append(\"div\").attr(\"id\", \"ctrl_button\");\n  ctrl_button.append(\"input\").attr(\"type\", \"button\").attr(\"value\", \"-\")\n    .on(\"click\", function(){\n      let begin = range[0] - (range[1] - range[0]) / 2;\n      let end = range[1] + (range[1] - range[0]) / 2;\n      if (begin < 0) {\n\tbegin = 0;\n\tend = (range[1] - range[0]) * 2;\n\tif (end > total) end = total;\n      }else if (end > total) {\n\tend = total;\n\tbegin = total - (range[1] - range[0]) * 2;\n\tif (begin < 0) begin - 0;\n      }\n      range = [begin, end];\n      reRender();\n    });\n  ctrl_button.append(\"input\").attr(\"type\", \"button\").attr(\"value\",\"+\")\n    .on(\"click\", function(){\n      let begin = range[0] + (range[1] - range[0]) / 4;\n      let end = range[1] - (range[1] - range[0]) / 4;\n      range = [begin, end];\n      reRender();\n    });\n  ctrl_button.append(\"input\").attr(\"type\", \"button\").attr(\"value\",\"reset\")\n    .on(\"click\", function(){\n      range = [];\n      reRender();\n    });\n\n  reRender();\n  \n  function reRender(){\n    \n    if (range[0] == undefined) {\n      range = [0,  Object.values(chromosomeNtLength.hg38).reduce((sum, value) => sum +value)];\n      total = range[1];\n    }\n    \n    max_log_p = 0;\n    \n    plot_g.html(\"\");\n    xlabel_g.html(\"\");\n    ylabel_g.html(\"\");\n    \n    plot_g.selectAll(\".plot\")\n      .data(dataset)\n      .enter()\n    // filter: display range\n      .filter(function(d){\n\tif (!d.pos) {\n\t  // calculate  accumulated position\n\t  let pos = 0;\n\t  for(let ch of chromosomes){\n\t    if (ch == d.Chromosome) break;\n\t    pos += chromosomeNtLength.hg38[ch];\n\t  }\n\t  d.pos = pos + parseInt(d.Physical_position);\n\t}\n\treturn range[0] <= d.pos && d.pos <= range[1];\n      })\n    // filter: low p-value\n      .filter(function(d){ return Math.log10(parseFloat(d.CLR_C_BMI_pv)) * (-1) > low_thresh })\n      .append(\"circle\")\n      .attr(\"class\", function(d, i){\n\tif (even_and_odd) {\n\t  let tmp = \"even\";\n\t  if (d.Chromosome == \"X\" || parseInt(d.Chromosome) % 2 == 1) tmp = \"odd\";\n\t  return \"plot ch_\" + tmp;\n\t}\n\treturn \"plot ch_\" + d.Chromosome\n      })\n      .attr(\"cx\", function(d){\n\treturn (d.pos - range[0]) / (range[1] - range[0]) * areaWidth + marginLeft})\n      .attr(\"cy\",function(d){\n\t// set max log(p-value)\n\tif (max_log_p < Math.log10(parseFloat(d.CLR_C_BMI_pv)) * (-1)) max_log_p = Math.log10(parseFloat(d.CLR_C_BMI_pv)) * (-1);\n\treturn areaHeight;\n      })\n      .attr(\"r\", 2)\n    // filter: high p-value\n      .filter(function(d){return Math.log10(parseFloat(d.CLR_C_BMI_pv)) * (-1) > high_thresh })\n      .classed(\"over-thresh-plot\", true)\n      .on(\"mouseover\", function(e, d){\n\tsvg.append(\"text\").text(d.dbSNP_RS_ID + \", \" + d.Symbol)\n\t  .attr(\"x\", d3.pointer(e)[0] + 10).attr(\"y\", d3.pointer(e)[1]).attr(\"id\", \"popup_text\");\n      })\n      .on(\"mouseout\", function(e, d){\n\tsvg.select(\"#popup_text\").remove();\n      });\n\n    // set 'cy' from max log(p-value) (int)\n    max_log_p_int = Math.floor(max_log_p);\n    plot_g.selectAll(\".plot\")\n      .attr(\"cy\", function(d){ return areaHeight  - (Math.log10(parseFloat(d.CLR_C_BMI_pv)) * (-1) - low_thresh) * areaHeight  / max_log_p_int});\n\n    // x axis label\n    xlabel_g.selectAll(\".xLabel\")\n      .data(chromosomes)\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"axisLabel xLabel\")\n      .text(function(d){ return d; })\n      .attr(\"x\", function(d){\n\tlet pos = chromosomeNtLength.hg38[d] / 2;\n\tfor(let ch of chromosomes){\n\t  if (ch == d) break;\n\t  pos += chromosomeNtLength.hg38[ch];\n\t}\n\treturn (pos - range[0]) / (range[1] - range[0]) * areaWidth + marginLeft;\n      })\n      .attr(\"y\", areaHeight + 20);\n\n    // y axis label\n    for (let i = Math.floor(low_thresh) + 1; i <=  max_log_p_int; i++) {\n      let y = areaHeight  - (i - low_thresh) * areaHeight / max_log_p_int;\n      ylabel_g.append(\"text\").text(i)\n\t.attr(\"class\", \"axisLabel yLabel\")\n\t.attr(\"x\", marginLeft - 16)\n\t.attr(\"y\", y)\n\t.attr(\"text-anchor\", \"end\");\n      ylabel_g.append(\"path\")\n\t.attr(\"class\", \"axis-line\")\n\t.attr(\"d\", \"M \" + (marginLeft - 10) + \", \" + y + \" H \" + marginLeft + \" Z\");\n    }\n    //// y zero (low_thresh)\n    ylabel_g.append(\"text\").text(low_thresh)\n      .attr(\"class\", \"axisLabel yLabel\")\n      .attr(\"x\", marginLeft - 16)\n      .attr(\"y\", areaHeight)\n      .attr(\"text-anchor\", \"end\");\n    ylabel_g.append(\"path\")\n      .attr(\"class\", \"axis-line\")\n      .attr(\"d\", \"M \" + (marginLeft - 10) + \", \" + areaHeight + \" H \" + marginLeft + \" Z\");\n\n    // slider\n    ctrl_svg.select(\"rect#slider\")\n      .attr(\"x\", marginLeft + range[0] / total * areaWidth)\n      .attr(\"width\", (range[1] - range[0]) / total * areaWidth)\n      .attr(\"transform\", \"translate(0, 0)\");\n\t\n  }\n}\n"],"names":["d3.select","d3.pointer","d3.drag"],"mappings":";;;;;AAGe,eAAe,aAAa,CAAC,MAAM,EAAE,MAAM,EAAE;AAC5D,EAAE,MAAM,CAAC,MAAM,CAAC;AAChB,IAAI,QAAQ,EAAE,iBAAiB;AAC/B,IAAI,UAAU,EAAE;AAChB,MAAM,KAAK,EAAE,MAAM,CAAC,KAAK;AACzB,KAAK;AACL,GAAG,CAAC,CAAC;AACL;AACA,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AAC1B,EAAE,IAAI,OAAO,GAAG,MAAM,UAAU,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC;AAClG,EAAE,IAAI,OAAO,OAAO,IAAI,QAAQ,EAAE,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;AAChE,CAAC;AACD;AACA,eAAe,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE;AAC7C,EAAE,MAAM,KAAK,GAAG,GAAG,CAAC;AACpB,EAAE,MAAM,MAAM,GAAG,GAAG,CAAC;AACrB,EAAE,MAAM,UAAU,GAAG,EAAE,CAAC;AACxB,EAAE,MAAM,YAAY,GAAG,EAAE,CAAC;AAC1B,EAAE,MAAM,SAAS,GAAG,KAAK,GAAG,UAAU,CAAC;AACvC,EAAE,MAAM,UAAU,GAAG,MAAM,GAAG,YAAY,CAAC;AAC3C;AACA,EAAE,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC5D,EAAE,MAAM,eAAe,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;AAChE;AACA,EAAE,IAAI,MAAM,CAAC,UAAU,IAAI,EAAE,EAAE,MAAM,CAAC,UAAU,GAAG,GAAG,CAAC;AACvD,EAAE,IAAI,MAAM,CAAC,WAAW,IAAI,EAAE,EAAE,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;AAC9D,EAAE,MAAM,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;AACnD,EAAE,MAAM,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;AACrD,EAAE,MAAM,YAAY,IAAI,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,CAAC;AACvD;AACA,EAAE,MAAM,WAAW,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AAC3J,EAAE,MAAM,kBAAkB,GAAG;AAC7B,IAAI,IAAI,EAAE;AACV,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,SAAS;AACnB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,CAAC,EAAE,SAAS;AAClB,MAAM,CAAC,EAAE,QAAQ;AACjB,KAAK;AACL,IAAG;AACH;AACA,EAAE,IAAI,GAAG,GAAGA,MAAS,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC/F,EAAE,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;AACxD,EAAE,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;AAClD,EAAE,IAAI,QAAQ,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACvD,EAAE,IAAI,QAAQ,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACvD;AACA,EAAE,IAAI,KAAK,GAAG,EAAE,CAAC;AACjB,EAAE,IAAI,SAAS,GAAG,CAAC,CAAC;AACpB,EAAE,IAAI,aAAa,GAAG,CAAC,CAAC;AACxB,EAAE,IAAI,KAAK,CAAC;AACZ;AACA;AACA,EAAE,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;AACvB,KAAK,IAAI,CAAC,GAAG,EAAE,IAAI,GAAG,UAAU,GAAG,IAAI,GAAG,UAAU,GAAG,KAAK,GAAG,KAAK,IAAI,IAAI,CAAC;AAC7E,KAAK,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;AAChC,EAAE,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;AACvB,KAAK,IAAI,CAAC,GAAG,EAAE,IAAI,GAAG,UAAU,GAAG,QAAQ,GAAG,UAAU,IAAI,IAAI,CAAC;AACjE,KAAK,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;AAChC;AACA;AACA,EAAE,IAAI,SAAS,GAAG,KAAK,CAAC;AACxB,EAAE,GAAG,CAAC,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACpC,IAAI,IAAIC,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,UAAU,EAAE;AACxC,MAAM,SAAS,GAAGA,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACnC,MAAM,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC;AACxB,EAAE,IAAI,CAAC,MAAM,EAAE,0BAA0B,CAAC;AAC1C,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC;AACzB,EAAE,IAAI,CAAC,GAAG,EAAE,SAAS,CAAC;AACtB,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;AACd,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;AAClB,EAAE,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC;AAC5B,EAAE,IAAI,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;AACzB,KAAK;AACL,GAAG,CAAC;AACJ,KAAK,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACnC,MAAM,GAAG,SAAS,CAAC;AACnB,CAAC,IAAI,OAAO,GAAGA,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChC,CAAC,IAAI,SAAS,GAAG,OAAO,EAAE;AAC1B,GAAG,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC;AAC1B,MAAM,IAAI,CAAC,OAAO,EAAE,OAAO,GAAG,SAAS,CAAC,CAAC;AACzC,EAAE,MAAM;AACR,GAAG,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC;AAC1B,MAAM,IAAI,CAAC,GAAG,EAAE,OAAO,CAAC;AACxB,MAAM,IAAI,CAAC,OAAO,EAAE,SAAS,GAAG,OAAO,CAAC,CAAC;AACzC,EAAE;AACF,OAAO;AACP,KAAK,CAAC;AACN,KAAK,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACjC,MAAM,GAAG,SAAS,CAAC;AACnB,CAAC,IAAI,OAAO,GAAGA,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAChC;AACA,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,GAAG,SAAS,EAAE;AAC/B,GAAG,KAAK,GAAG,CAAC,OAAO,GAAG,KAAK,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,GAAG,KAAK,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;AACtH,GAAG,QAAQ,EAAE,CAAC;AACd,EAAE,MAAM,IAAI,OAAO,GAAG,SAAS,GAAG,CAAC,EAAE;AACrC,GAAG,KAAK,GAAG,CAAC,SAAS,GAAG,KAAK,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,OAAO,GAAG,KAAK,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;AACtH,GAAG,QAAQ,EAAE,CAAC;AACd,EAAE;AACF,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,MAAM,EAAE,CAAC;AAClC,CAAC,SAAS,GAAG,KAAK,CAAC;AACnB,OAAO;AACP,KAAK,CAAC,CAAC;AACP;AACA;AACA,EAAE,IAAI,QAAQ,GAAGD,MAAS,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;AAClG,EAAE,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC;AACzB,KAAK,IAAI,CAAC,GAAG,EAAE,IAAI,GAAG,UAAU,GAAG,SAAS,GAAG,KAAK,IAAI,IAAI,CAAC;AAC7D,KAAK,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC;AAC9B,KAAK,IAAI,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;AACjC,EAAE,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC;AACzB,KAAK,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;AACzB,KAAK,IAAI,CAAC,GAAG,EAAE,UAAU,CAAC;AAC1B,KAAK,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;AACjB,KAAK,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC;AAC7B,KAAK,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC;AACvB,KAAK,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC;AAC5B,KAAK,IAAI;AACT,MAAME,IAAO,EAAE;AACf,EAAE,EAAE,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,EAAE,SAAS,GAAG,CAAC,CAAC,EAAC,EAAE,CAAC;AAC7C,EAAE,EAAE,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;AACxB,GAAG,GAAG,SAAS,EAAE;AACjB,KAAK,IAAI,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AACjD,KAAK,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;AACjC,KAAK,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,GAAG,UAAU,EAAE,KAAK,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC;AACvH,UAAU,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,KAAK,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AACjL,KAAK,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,YAAY,GAAG,KAAK,GAAG,MAAM,CAAC,CAAC;AAC7D,IAAI;AACJ,EAAE,CAAC;AACH,EAAE,EAAE,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;AACvB,GAAG,GAAG,SAAS,CAAC;AAChB;AACA,KAAK,IAAI,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AACjD,KAAK,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC;AACjC,KAAK,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,GAAG,UAAU,EAAE,KAAK,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC;AACvH,UAAU,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,KAAK,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AACjL,KAAK,IAAI,IAAI,GAAG,KAAK,GAAG,SAAS,GAAG,KAAK,CAAC;AAC1C,KAAK,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;AAChD,KAAK,QAAQ,EAAE,CAAC;AAChB,KAAK,SAAS,GAAG,KAAK,CAAC;AACvB,IAAI;AACJ,EAAE,CAAC;AACH,KAAK,CAAC;AACN;AACA;AACA,EAAE,IAAI,WAAW,GAAGF,MAAS,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;AACvF,EAAE,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC;AACvE,KAAK,EAAE,CAAC,OAAO,EAAE,UAAU;AAC3B,MAAM,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACvD,MAAM,IAAI,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACrD,MAAM,IAAI,KAAK,GAAG,CAAC,EAAE;AACrB,CAAC,KAAK,GAAG,CAAC,CAAC;AACX,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACjC,CAAC,IAAI,GAAG,GAAG,KAAK,EAAE,GAAG,GAAG,KAAK,CAAC;AAC9B,OAAO,KAAK,IAAI,GAAG,GAAG,KAAK,EAAE;AAC7B,CAAC,GAAG,GAAG,KAAK,CAAC;AACb,CAAC,KAAK,GAAG,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AAE3C,OAAO;AACP,MAAM,KAAK,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;AAC3B,MAAM,QAAQ,EAAE,CAAC;AACjB,KAAK,CAAC,CAAC;AACP,EAAE,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;AACtE,KAAK,EAAE,CAAC,OAAO,EAAE,UAAU;AAC3B,MAAM,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACvD,MAAM,IAAI,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACrD,MAAM,KAAK,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;AAC3B,MAAM,QAAQ,EAAE,CAAC;AACjB,KAAK,CAAC,CAAC;AACP,EAAE,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;AAC1E,KAAK,EAAE,CAAC,OAAO,EAAE,UAAU;AAC3B,MAAM,KAAK,GAAG,EAAE,CAAC;AACjB,MAAM,QAAQ,EAAE,CAAC;AACjB,KAAK,CAAC,CAAC;AACP;AACA,EAAE,QAAQ,EAAE,CAAC;AACb;AACA,EAAE,SAAS,QAAQ,EAAE;AACrB;AACA,IAAI,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;AAC/B,MAAM,KAAK,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,KAAK,KAAK,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC;AAC9F,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AACvB,KAAK;AACL;AACA,IAAI,SAAS,GAAG,CAAC,CAAC;AAClB;AACA,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACpB,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACtB,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACtB;AACA,IAAI,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC;AAC7B,OAAO,IAAI,CAAC,OAAO,CAAC;AACpB,OAAO,KAAK,EAAE;AACd;AACA,OAAO,MAAM,CAAC,SAAS,CAAC,CAAC;AACzB,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE;AACb;AACA,GAAG,IAAI,GAAG,GAAG,CAAC,CAAC;AACf,GAAG,IAAI,IAAI,EAAE,IAAI,WAAW,CAAC;AAC7B,KAAK,IAAI,EAAE,IAAI,CAAC,CAAC,UAAU,EAAE,MAAM;AACnC,KAAK,GAAG,IAAI,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACxC,IAAI;AACJ,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,QAAQ,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC;AAC/C,EAAE;AACF,CAAC,OAAO,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;AAC/C,OAAO,CAAC;AACR;AACA,OAAO,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,EAAE,CAAC;AAC/F,OAAO,MAAM,CAAC,QAAQ,CAAC;AACvB,OAAO,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACnC,CAAC,IAAI,YAAY,EAAE;AACnB,GAAG,IAAI,GAAG,GAAG,MAAM,CAAC;AACpB,GAAG,IAAI,CAAC,CAAC,UAAU,IAAI,GAAG,IAAI,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC;AAC3E,GAAG,OAAO,UAAU,GAAG,GAAG,CAAC;AAC3B,EAAE;AACF,CAAC,OAAO,UAAU,GAAG,CAAC,CAAC,UAAU;AACjC,OAAO,CAAC;AACR,OAAO,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AAC7B,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,UAAU,CAAC,CAAC;AAC7E,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;AAC5B;AACA,CAAC,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAC1H,CAAC,OAAO,UAAU,CAAC;AACnB,OAAO,CAAC;AACR,OAAO,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;AACnB;AACA,OAAO,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,WAAW,EAAE,CAAC;AAC/F,OAAO,OAAO,CAAC,kBAAkB,EAAE,IAAI,CAAC;AACxC,OAAO,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACrC,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,GAAG,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC;AACzD,IAAI,IAAI,CAAC,GAAG,EAAEC,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,EAAEA,OAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;AAC1F,OAAO,CAAC;AACR,OAAO,EAAE,CAAC,UAAU,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC;AACpC,CAAC,GAAG,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,CAAC;AACpC,OAAO,CAAC,CAAC;AACT;AACA;AACA,IAAI,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AAC1C,IAAI,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC;AAC7B,OAAO,IAAI,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,EAAE,OAAO,UAAU,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,IAAI,UAAU,IAAI,aAAa,CAAC,CAAC,CAAC;AACjJ;AACA;AACA,IAAI,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC;AACjC,OAAO,IAAI,CAAC,WAAW,CAAC;AACxB,OAAO,KAAK,EAAE;AACd,OAAO,MAAM,CAAC,MAAM,CAAC;AACrB,OAAO,IAAI,CAAC,OAAO,EAAE,kBAAkB,CAAC;AACxC,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC;AACrC,OAAO,IAAI,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;AAC5B,CAAC,IAAI,GAAG,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AAC1C,CAAC,IAAI,IAAI,EAAE,IAAI,WAAW,CAAC;AAC3B,GAAG,IAAI,EAAE,IAAI,CAAC,EAAE,MAAM;AACtB,GAAG,GAAG,IAAI,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACtC,EAAE;AACF,CAAC,OAAO,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,UAAU,CAAC;AAC1E,OAAO,CAAC;AACR,OAAO,IAAI,CAAC,GAAG,EAAE,UAAU,GAAG,EAAE,CAAC,CAAC;AAClC;AACA;AACA,IAAI,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,aAAa,EAAE,CAAC,EAAE,EAAE;AACvE,MAAM,IAAI,CAAC,GAAG,UAAU,IAAI,CAAC,CAAC,GAAG,UAAU,IAAI,UAAU,GAAG,aAAa,CAAC;AAC1E,MAAM,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AACrC,EAAE,IAAI,CAAC,OAAO,EAAE,kBAAkB,CAAC;AACnC,EAAE,IAAI,CAAC,GAAG,EAAE,UAAU,GAAG,EAAE,CAAC;AAC5B,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;AACd,EAAE,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AAC7B,MAAM,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC;AAC7B,EAAE,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;AAC5B,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,UAAU,GAAG,EAAE,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,KAAK,GAAG,UAAU,GAAG,IAAI,CAAC,CAAC;AAC7E,KAAK;AACL;AACA,IAAI,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC;AAC5C,OAAO,IAAI,CAAC,OAAO,EAAE,kBAAkB,CAAC;AACxC,OAAO,IAAI,CAAC,GAAG,EAAE,UAAU,GAAG,EAAE,CAAC;AACjC,OAAO,IAAI,CAAC,GAAG,EAAE,UAAU,CAAC;AAC5B,OAAO,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AAClC,IAAI,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC;AAC3B,OAAO,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;AACjC,OAAO,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,UAAU,GAAG,EAAE,CAAC,GAAG,IAAI,GAAG,UAAU,GAAG,KAAK,GAAG,UAAU,GAAG,IAAI,CAAC,CAAC;AAC3F;AACA;AACA,IAAI,QAAQ,CAAC,MAAM,CAAC,aAAa,CAAC;AAClC,OAAO,IAAI,CAAC,GAAG,EAAE,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,GAAG,SAAS,CAAC;AAC3D,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,GAAG,SAAS,CAAC;AAC/D,OAAO,IAAI,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;AAC5C;AACA,GAAG;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}